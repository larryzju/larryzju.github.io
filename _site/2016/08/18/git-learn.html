<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>larryzju 的博客 - pro git 笔记</title>
  <meta name="author" content="larryzju 的博客" />
  <meta name="description" content="The blog of larryzju 的博客" />
  <link rel="canonical" href="http://localhost:4000/2016/08/18/git-learn.html" />

  <link href="//fonts.googleapis.com/css?family=Open+Sans:600,800" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="/favicon.png">
  <link rel="alternate" type="application/atom+xml" title="larryzju 的博客" href="http://localhost:4000/atom.xml" />

  <link rel="stylesheet" href="/assets/css/all.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha256-k2/8zcNbxVIh5mnQ52A0r3a6jAgMGxFJFE2707UxGCk= sha512-ZV9KawG2Legkwp3nAlxLIVFudTauWuBpC10uEafMHYL0Sarrz5A7G79kXh5+5+woxQ5HM559XX2UZjMJ36Wplg==" crossorigin="anonymous">
</head>
<body>
  <div class="container">
    <div class="four columns sidebar">
      <nav>
  <a href="/">
    
    <img class='width: 100px' src="/logo.png" id="logo" alt="Blog logo"/>
    
  </a>

  <h2><a href="/">larryzju 的博客</a></h2>

  <div id="links">
    <h3>Links</h3>
<ul>
  <li><a href="https://larryzju.github.io/diary/index.html">笔记 (gitpage)</a></li>
  <li><a href="https://github.com/larryzju/diary">笔记源码</a></li>
</ul>

  </div>

  <div id="tags">
    <h3>Tags</h3>


<ul>
  
  <li>
    <a href="/tag/快学scala题解.html" rel="tag">
      <span class="tag-id">快学scala题解</span>
      <span class="tag-count">7</span>
    </a>
  </li>
  
  <li>
    <a href="/tag/杂记.html" rel="tag">
      <span class="tag-id">杂记</span>
      <span class="tag-count">11</span>
    </a>
  </li>
  
  <li>
    <a href="/tag/计算机.html" rel="tag">
      <span class="tag-id">计算机</span>
      <span class="tag-count">15</span>
    </a>
  </li>
  
</ul>

  </div>

  <div id="social">
    Follow me:
<div id="stalker">
  
  <a title="larryzju on Github" href="https://github.com/larryzju">
    <i class="fa fa-github-square"></i>
  </a>
  

  

  

  

  

  

  

  

  

  

  

  
  <a title="Atom feed" id="atom" href="/atom.xml">
    <i class="fa fa-rss-square"></i>
  </a>
  
</div>

  </div>

</nav>

    </div>

    <div class="eleven columns content">
      <p class="meta">
  August 18, 2016
  <a href="/">
    <i class="home fa fa-home"></i>
  </a>
</p>

<h1 class="title">pro git 笔记</h1>

<div id="post">
  <h1 id="基础">基础</h1>

<h2 id="名词">名词</h2>

<ul>
  <li>repository</li>
  <li>track</li>
  <li>stage</li>
  <li>commit</li>
  <li>pull</li>
  <li>push</li>
</ul>

<h2 id="创建仓库">创建仓库</h2>

<ol>
  <li>
    <p>创建全新仓库</p>

    <pre><code class="language-shell">$ git init
$ git add (files)
$ git commit -m (message)
</code></pre>
  </li>
  <li>
    <p>克隆仓库</p>

    <pre><code class="language-shell">$ git clone [url`
</code></pre>
    <p>克隆到的是远程几乎所有数据，而非仅为当前需要用到的数据</p>
  </li>
</ol>

<h2 id="提交">提交</h2>

<p>被 git 管理的文件为已跟踪状态，其它为未跟踪。已跟踪的文件状态又可细分为：未修改、已修改和已暂存。四者之前的转换关系如下：</p>

<ul>
  <li><em>未修改</em> 文件可以从 git 中移除(remove)，状态变为 <em>未跟踪</em></li>
  <li><em>未跟踪</em> 文件通过 <code>add</code> 命令加入 git 管理，状态变为 <em>已暂存</em></li>
  <li><em>已修改</em> 文件同样通过 <code>add</code> 命令加入暂存区，状态变为 <em>已暂存</em></li>
  <li><em>已暂存</em> 文件可以提交（ <code>commit</code> ）并创建快照 ，状态变为 <em>未修改</em></li>
</ul>

<p>通过 <code>.gitignore</code> 来设置文件匹配模式，自动忽略某些特定名称的文件（或目录）</p>

<p>常用的命令如下：</p>

<ul>
  <li><code>git status -s/--short</code> 查看状态</li>
  <li><code>git diff [--staged/--cached]</code> 查看不同，加 cached 参数查看已暂存文件的不同</li>
  <li><code>git add</code> 加入未跟踪或已修改文件到暂存区</li>
  <li><code>git commit [-a] [-m] [-v]</code> 提交暂存修改</li>
  <li><code>git rm --cached</code> 剔除文件（从git管理），加 cached 参数保留原文件</li>
  <li><code>git mv</code> 重命名文件</li>
</ul>

<h2 id="历史">历史</h2>

<p>通过 <code>git log</code> 查看提交历史，有非常多的参数可选，常用的有</p>

<ul>
  <li><code>-p</code> 显示具体修改内容</li>
  <li><code>-2</code> 仅显示最近两修改</li>
  <li><code>--stat</code> 显示统计信息（逐文件）</li>
  <li><code>--sshortstat</code> 显示简要统计信息</li>
  <li><code>--pretty format</code>，指定显示格式，例如 oneline, short, full, fuller, 具体的格式（类似printf）</li>
</ul>

<blockquote>
  <p><code>author</code> vs <code>commitor</code>
一次提交可能有不同的作者和提交者，前者是作出修改的人，后者是将修改提交到 git 的人</p>
</blockquote>

<h2 id="撤消">撤消</h2>

<p><strong>撤消操作可能会导致不可逆的数据丢失，谨慎操作！</strong></p>

<p>三种常见的撤消操作如下</p>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>git commit --amend</code></td>
      <td>重新提交，若快照无改动则只修改提交内容</td>
    </tr>
    <tr>
      <td><code>git reset HEAD &lt;file&gt;</code></td>
      <td>从暂存区域中移除，但不修改文件内容</td>
    </tr>
    <tr>
      <td><code>git checckout -- &lt;file&gt;</code></td>
      <td>检出文件内容，<strong>危险，对文件作的所有修改都被覆盖</strong></td>
    </tr>
  </tbody>
</table>

<h2 id="远程仓库">远程仓库</h2>

<p>相对本地仓库（当前目录）而言，指托管在网络中的版本库。同一个GIT仓库可以同时有多个远程仓库，常用命令如下</p>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>git remote -v</code></td>
      <td>显示远程仓库列表</td>
    </tr>
    <tr>
      <td><code>git remove add &lt;snortname&gt; &lt;url&gt;</code></td>
      <td>添加一个新的远程仓库</td>
    </tr>
    <tr>
      <td><code>git fetch [remote-name]</code></td>
      <td>访问远程仓库，从中同步增量数据</td>
    </tr>
    <tr>
      <td><code>git pull</code></td>
      <td>拉取并合并（仅对于跟踪远程分支）</td>
    </tr>
    <tr>
      <td><code>git push [remote-name] [branch-name]</code></td>
      <td>推送本地分支到远端仓库，需要先拉取合并再推送</td>
    </tr>
    <tr>
      <td><code>git remote show [remote-name]</code></td>
      <td>显示远程仓库详情</td>
    </tr>
    <tr>
      <td><code>git remote rm [remote-name]</code></td>
      <td>删除远程仓库</td>
    </tr>
    <tr>
      <td><code>git remote rename [from] [to]</code></td>
      <td>重命名远程仓库</td>
    </tr>
  </tbody>
</table>

<h2 id="标签">标签</h2>

<p>指向某次提交，是之打上一个标记，常用于标记发行版本号。分为两种：</p>

<ol>
  <li>lightweight tag</li>
  <li>annotated tag</li>
</ol>

<p>前者是对某提交的引用，后者是一个完整的对象，包含独立的提交信息和备注</p>

<p>常用操作如下：</p>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>git tag -l</code></td>
      <td>列出 tag</td>
    </tr>
    <tr>
      <td><code>git tag v1.4-lw</code></td>
      <td>添加轻量 tag</td>
    </tr>
    <tr>
      <td><code>git tag -a v1.4 -m "&lt;description&gt;" [ref]</code></td>
      <td>添加附注标签</td>
    </tr>
    <tr>
      <td><code>git show [tagname]</code></td>
      <td>显示 tag 详细信息</td>
    </tr>
    <tr>
      <td><code>git push origin [tagname|--tags]</code></td>
      <td>推送指定/全部 tag 到远程仓库</td>
    </tr>
    <tr>
      <td><code>git checkout -b [branchname] [tagname]</code></td>
      <td>按 tag 内容创建一个新的分支</td>
    </tr>
  </tbody>
</table>

<h2 id="别名">别名</h2>

<p>通过 <code>git config --global alias.&lt;alias&gt; [fullcommand]</code> 来设置别名，fullcommand 可以是 git 的命令也可以是外部命令（以 “!” 开头）</p>

<h1 id="branch分支">Branch（分支）</h1>

<h2 id="基础概念">基础概念</h2>

<p>GIT 对象分为三级：</p>

<ol>
  <li>文件快照，生成 blob 对象（原数据带 sha1 校验）；</li>
  <li>提交信息与提交的文件树，生成 tree 对象</li>
  <li>与分支对应的 commit 对象，指向 tree 对象，并有 parent 表示上一次提交的路径</li>
</ol>

<p>分支可以看作一个轻量指针，因此 git 中可以方便和简单的操纵多个分支。</p>

<p>分支操作的常用命令有：</p>

<ol>
  <li>branch: 新建一个分支，即新建一个 commit 对象指向 HEAD 指针
    <blockquote>
      <p>HEAD 是特殊的指针，指向当前所在的本地分支</p>
    </blockquote>
  </li>
  <li>checkout: 切换分支（ 修改 HEAD 指向 ），并恢复工作目录内容</li>
  <li>commit: 提交</li>
  <li>log: 常用参数有 –graph-all –decorate</li>
</ol>

<h2 id="分支与合并">分支与合并</h2>

<p>分支使得可以随时从任何一处开启一个全新的开发过程。</p>

<p>两个分支形成分叉（diverged），分叉有两类关系</p>
<ol>
  <li>祖孙关系</li>
  <li>公共的祖先关系</li>
</ol>

<p>多个分支可能需要合并，以集成不同阶段的开发成果。使用 <code>merge</code> 命令进行自动合并，合并时：</p>

<ol>
  <li>祖孙关系：祖先提交指针右移，称作 fast-forward</li>
  <li>公共祖先关系：进行三方合并（merge-in, merge-into, common-ancestor）</li>
</ol>

<p>若两个分支对同一文件同一内容进行不一致的修改，无法自动合并。需要手工进行冲突排除</p>

<ol>
  <li>使用 git status 观察其中的 unmerged 文件</li>
  <li>手工编辑解决冲突或使用 <code>mergetool</code> 进行操作</li>
  <li>add，commit 解决提交并记录解决方法</li>
</ol>

<h2 id="分支管理">分支管理</h2>

<p><code>git branch</code> 有多种选项，其中参数 <code>--merged</code> 和 <code>--no-merged</code> 可以限制分支选择方式
对于已经合并过的分支，可以放心删除之 <code>git branch -d</code> 而不损失历史内容</p>

<h2 id="分支策略">分支策略</h2>

<p>分支有些习惯的用法，包含有：</p>

<ol>
  <li>
    <p>流水线模式
提供不同级别的稳定性，master 保持稳定，将更新的开发置于 develop 分支</p>
  </li>
  <li>
    <p>特性分支模式
将不同的需求开发分布于不同的短期分支中，方便进行上下文切换（context-switch），易于进行代码审查</p>
  </li>
</ol>

<h2 id="远程分支">远程分支</h2>

<p>GIT 可以对多个远程仓库进行引用，使用 <code>ls-remote</code> 或 <code>remote show</code> 查看</p>

<blockquote>
  <p>对远程引用的只读操作在本地进行，其状态是最后一次通信时的记录，用 <code>fetch</code> 命令更新</p>
</blockquote>

<p>远程引用包含了分支、标签等内容，远程分支表示为 <code>remotes/(remote)/(branch)</code></p>

<h3 id="创建跟踪分支">创建跟踪分支</h3>

<p><code>clone</code> 远程仓库，生成 master 分支，与 origin/master 远程分支关联，称为跟踪分支（track）或上游分支（upstream）。也可以通过以下命令生成：</p>

<ul>
  <li><code>git checkout -b serverfix origin/serverfix</code></li>
  <li><code>git checkout --track origin/serverfix</code></li>
</ul>

<h3 id="推送远程分支">推送远程分支</h3>

<p>本地分支通过 <code>push</code> 进行推送：</p>

<p><code>git push (remote) (branch)</code></p>

<blockquote>
  <p>上述 branch 完整应为 <code>(local-branch):(remote-branch)</code></p>
</blockquote>

<h3 id="同步跟踪分支">同步跟踪分支</h3>

<p>使用 <code>git pull</code>，更明确的方法是先同步后合并</p>

<ol>
  <li><code>git fetch</code></li>
  <li><code>git merge</code></li>
</ol>

<h3 id="删除远程分支">删除远程分支</h3>

<p><code>git push --delete serverfix</code></p>

<h2 id="变基rebase">变基(rebase)</h2>

<p>与 merge 进行三方合并效果一样，用于保证提交历史的整洁。rebase 后主分支只需要快进合并（fast-forward）即可</p>

<p>Rebase 原理是提取当前分支 C4 相对公共祖先提交 C2 的修改，在主分支 C3 进行重演。rebase 会遮掩提交历史，而且可能造成一些麻烦，merge 相对安全。</p>

<p>总的原则是 <strong>只对尚未推送或分享给别人的本地修改执行变基操作清理历史，从不对已推送至别处的提交执行变基操作</strong> ，并在可能的情况下使用 <code>git pull --rebase</code> 来保证合并安全</p>

</div>

<div id="related">
  <h3>Related Posts</h3>
  <ul class="posts">
    
    <li>
      <span>28 Jun 2017 &raquo;</span> <a href="/2017/06/28/grub2-windows.html">windows 安装小记</a>
    </li>
    
    <li>
      <span>21 Jun 2017 &raquo;</span> <a href="/2017/06/21/%E6%96%B0%E4%B8%9C%E6%96%B9%E5%BF%AB%E8%BD%A6%E8%B0%8B%E6%9D%80%E6%A1%88.html">《新东方快车谋杀案》观后记</a>
    </li>
    
    <li>
      <span>17 Jun 2017 &raquo;</span> <a href="/2017/06/17/%E6%81%B0%E5%90%8C%E5%AD%A6%E5%B0%91%E5%B9%B4.html">《恰同学少年》读后记</a>
    </li>
    
  </ul>

  <h3>Tags :</h3>
  <span>
    
      <a href="/tag/计算机.html" rel="tag"> 
         计算机 
        
        .
        
      </a>

  </span>
</div>



      <div class="footer">
        <div class="disclaimer">
  
  <p>
  唯学无际，际于天地
  </p>
  

  <p>
    © larryzju 的博客, 2017 &mdash; built with <a href="http://jekyllrb.com/">Jekyll</a> using <a href="https://github.com/swanson/lagom">Lagom theme</a>
  </p>
</div>

      </div>
    </div>
  </div>


</body>
</html>
